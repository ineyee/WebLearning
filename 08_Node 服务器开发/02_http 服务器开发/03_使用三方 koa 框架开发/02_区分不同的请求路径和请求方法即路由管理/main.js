// å½“æˆ‘ä»¬ä½¿ç”¨è·¯ç”±ç®¡ç†æ—¶ï¼Œæ¯ä¸ªæ¨¡å—çš„æ¥å£éƒ½å†™åœ¨å•ç‹¬çš„æ–‡ä»¶â€”â€”æ¨¡å—â€”â€”é‡Œï¼Œç„¶åé€šè¿‡è·¯ç”±æ¥ç®¡ç†è¿™äº›æ¥å£
// è¿™æ ·å¯ä»¥è®© app å¯¹è±¡ä¿æŒç®€æ´ï¼Œæœ‰åˆ©äºç»´æŠ¤
// 
// è·¯ç”±ç®¡ç†çš„ä½¿ç”¨æ­¥éª¤ï¼š
// 1ã€å®‰è£…è·¯ç”±ç®¡ç†åº“ @koa/routerï¼Œcd åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šnpm install @koa/router
// 2ã€åˆ›å»ºä¸“å±äºæŸä¸ªæ¨¡å—æ¥å£çš„è·¯ç”±æ–‡ä»¶
// 3ã€åœ¨è·¯ç”±æ–‡ä»¶ä¸­åˆ›å»ºè·¯ç”±å®ä¾‹
// 4ã€åœ¨è·¯ç”±æ–‡ä»¶ä¸­çš„è·¯ç”±å®ä¾‹ä¸ŠæŒ‚è½½è·¯ç”±
// 5ã€åœ¨è·¯ç”±æ–‡ä»¶ä¸­å¯¼å‡ºè·¯ç”±å®ä¾‹
// ------
// 6ã€åœ¨ app å¯¹è±¡æ‰€åœ¨çš„æ–‡ä»¶ä¸­å¼•å…¥è·¯ç”±æ–‡ä»¶
// 7ã€åœ¨ app å¯¹è±¡ä¸Šä½¿ç”¨è·¯ç”±

const Koa = require("koa");
const app = new Koa();
app.listen(8000, () => {
  console.log("ğŸš€æœåŠ¡å™¨å¯åŠ¨æˆåŠŸğŸš€");
});

// 6ã€åœ¨ app å¯¹è±¡æ‰€åœ¨çš„æ–‡ä»¶ä¸­å¼•å…¥è·¯ç”±æ–‡ä»¶
const userRouter = require("./router/user-router");
const songRouter = require("./router/song-router");

// 7ã€åœ¨ app å¯¹è±¡ä¸­ä½¿ç”¨è·¯ç”±
app.use(userRouter.routes());
// allowedMethods() æ˜¯ koa-router æä¾›çš„ä¸€ä¸ªä¸­é—´ä»¶æ–¹æ³•ï¼Œå»ºè®®åœ¨æ¯ä¸ªè·¯ç”±åé¢éƒ½è·Ÿä¸€ä¸ª
// 
// å¦‚æœä¸ä½¿ç”¨è¿™ä¸ªä¸­é—´ä»¶ï¼Œé‚£ä¹ˆå½“å®¢æˆ·ç«¯å‘é€ä¸æ”¯æŒçš„ HTTP æ–¹æ³•æ—¶ï¼š
// - é»˜è®¤è¿”å› 404 Not Foundï¼ˆé”™è¯¯ä¿¡æ¯ä¸å‡†ç¡®ï¼‰
// - æ—  Allow å¤´ï¼ˆå®¢æˆ·ç«¯ä¸çŸ¥é“å¯ç”¨æ–¹æ³•ï¼‰
// 
// ä½¿ç”¨è¿™ä¸ªä¸­é—´ä»¶ï¼Œé‚£ä¹ˆå½“å®¢æˆ·ç«¯å‘é€ä¸æ”¯æŒçš„ HTTP æ–¹æ³•æ—¶ï¼š
// - è¿”å› 405 Method Not Allowedï¼ˆç²¾å‡†çŠ¶æ€ç ï¼‰
// - æºå¸¦ Allow: GET, POST... å¤´ï¼ˆè‡ªæ–‡æ¡£åŒ–ï¼‰
app.use(userRouter.allowedMethods());

app.use(songRouter.routes());
app.use(songRouter.allowedMethods());


